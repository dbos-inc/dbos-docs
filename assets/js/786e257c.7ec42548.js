"use strict";(self.webpackChunkdbos_docs=self.webpackChunkdbos_docs||[]).push([[1436],{3417:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"typescript/integrating-dbos","title":"Add DBOS To Your App","description":"This guide shows you how to add the open-source DBOS Transact library to your existing application to durably execute it and make it resilient to any failure.","source":"@site/docs/typescript/integrating-dbos.md","sourceDirName":"typescript","slug":"/typescript/integrating-dbos","permalink":"/typescript/integrating-dbos","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"sidebar_position":20,"title":"Add DBOS To Your App"},"sidebar":"tutorialSidebar","previous":{"title":"Learn DBOS TypeScript","permalink":"/typescript/programming-guide"},"next":{"title":"AI Model Prompting","permalink":"/typescript/prompting"}}');var r=t(4848),i=t(8453);const s={sidebar_position:20,title:"Add DBOS To Your App"},a=void 0,l={},c=[{value:"Using DBOS Transact",id:"using-dbos-transact",level:3},{value:"1. Install DBOS",id:"1-install-dbos",level:4},{value:"2. Launch DBOS in Your App",id:"2-launch-dbos-in-your-app",level:4},{value:"3. Start Your Application",id:"3-start-your-application",level:4},{value:"4. Start Building With DBOS",id:"4-start-building-with-dbos",level:4}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["This guide shows you how to add the open-source ",(0,r.jsx)(n.a,{href:"https://github.com/dbos-inc/dbos-transact-ts",children:"DBOS Transact"})," library to your existing application to ",(0,r.jsx)(n.strong,{children:"durably execute"})," it and make it resilient to any failure."]}),"\n",(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsx)(n.p,{children:"Also check out the integration guides for popular TypeScript frameworks:"}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/integrations/nestjs",children:"Nest.js + DBOS"})}),"\n"]})]}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"Due to its internal workflow registry, The DBOS library and DBOS workflows cannot be bundled with JavaScript or TypeScript bundlers (Webpack, Vite, Rollup, esbuild, Parcel, etc.) and must be treated as an external library by these tools."})}),"\n",(0,r.jsx)(n.h3,{id:"using-dbos-transact",children:"Using DBOS Transact"}),"\n",(0,r.jsx)(n.h4,{id:"1-install-dbos",children:"1. Install DBOS"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"npm install"})," DBOS into your application. Note that DBOS requires Node.js 20 or later."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"npm install @dbos-inc/dbos-sdk@latest\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Optionally"}),", if you want to use TypeScript decorators, enable them in your ",(0,r.jsx)(n.code,{children:"tsconfig.json"})," file:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="tsconfig.json"',children:'  "compilerOptions": {\n    "experimentalDecorators": true,\n  }\n'})}),"\n",(0,r.jsxs)(n.p,{children:["DBOS requires a Postgres database.\nIf you already have Postgres, you can set the ",(0,r.jsx)(n.code,{children:"DBOS_SYSTEM_DATABASE_URL"})," environment variable to your connection string (later we'll pass that value into DBOS).\nOtherwise, you can start Postgres in a Docker container with this command:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"npx dbos postgres start\n"})}),"\n",(0,r.jsx)(n.h4,{id:"2-launch-dbos-in-your-app",children:"2. Launch DBOS in Your App"}),"\n",(0,r.jsx)(n.p,{children:"In your app's main entrypoint, add code to configure and launch DBOS:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'import { DBOS } from "@dbos-inc/dbos-sdk";\n\nDBOS.setConfig({\n  "name": "my-app",\n  "systemDatabaseUrl": process.env.DBOS_SYSTEM_DATABASE_URL,\n});\nawait DBOS.launch();\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Both ",(0,r.jsx)(n.code,{children:"DBOS.setConfig"})," and ",(0,r.jsx)(n.code,{children:"DBOS.launch"})," should be called after your app is created, but before it begins processing requests."]}),"\n",(0,r.jsx)(n.h4,{id:"3-start-your-application",children:"3. Start Your Application"}),"\n",(0,r.jsxs)(n.p,{children:["Try starting your application.\nIf everything is set up correctly, your app should run normally, but log ",(0,r.jsx)(n.code,{children:"DBOS launched!"})," on startup.\nCongratulations!  You've integrated DBOS into your application."]}),"\n",(0,r.jsx)(n.h4,{id:"4-start-building-with-dbos",children:"4. Start Building With DBOS"}),"\n",(0,r.jsxs)(n.p,{children:["At this point, you can apply DBOS durability to your functions.\nFor example, you can register one of your functions as a ",(0,r.jsx)(n.a,{href:"/typescript/tutorials/workflow-tutorial",children:"workflow"})," and call other functions as ",(0,r.jsx)(n.a,{href:"/typescript/tutorials/step-tutorial",children:"steps"}),".\nDBOS durably executes the workflow so if it is ever interrupted, upon restart it automatically resumes from the last completed step."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'async function stepOne() {\n  DBOS.logger.info("Step one completed!");\n}\n\nasync function stepTwo() {\n  DBOS.logger.info("Step two completed!");\n}\n\nasync function workflowFunction() {\n  await DBOS.runStep(() => stepOne(), {name: "stepOne"});\n  await DBOS.runStep(() => stepTwo(), {name: "stepTwo"});\n}\nconst workflow = DBOS.registerWorkflow(workflowFunction)\n\nawait workflow();\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.strong,{children:["You must register all workflows before calling ",(0,r.jsx)(n.code,{children:"DBOS.launch()"})]}),"\nAs workflow recovery will commence after ",(0,r.jsx)(n.code,{children:"DBOS.launch()"}),", it is essential that all workflows, queues, and other resources be registered before this point."]}),"\n",(0,r.jsx)(n.p,{children:"You can add DBOS to your application incrementally\u2014it won't interfere with code that's already there.\nIt's totally okay for your application to have one DBOS workflow alongside thousands of lines of non-DBOS code."}),"\n",(0,r.jsxs)(n.p,{children:["To learn more about programming with DBOS, check out ",(0,r.jsx)(n.a,{href:"/typescript/programming-guide",children:"the programming guide"}),"."]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var o=t(6540);const r={},i=o.createContext(r);function s(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);