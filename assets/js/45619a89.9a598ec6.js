"use strict";(self.webpackChunkdbos_docs=self.webpackChunkdbos_docs||[]).push([[7602],{1404:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"integrations/pydantic-ai","title":"Pydantic AI","description":"Pydantic AI is a Python agent framework for building production-grade applications and workflows powered by Generative AI.","source":"@site/docs/integrations/pydantic-ai.md","sourceDirName":"integrations","slug":"/integrations/pydantic-ai","permalink":"/integrations/pydantic-ai","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Pydantic AI","hide_table_of_contents":false},"sidebar":"tutorialSidebar","previous":{"title":"Supabase","permalink":"/integrations/supabase"},"next":{"title":"Logfire","permalink":"/integrations/logfire"}}');var a=i(4848),s=i(8453);const o={sidebar_position:2,title:"Pydantic AI",hide_table_of_contents:!1},r="Use DBOS With Pydantic AI",d={},l=[{value:"Overview",id:"overview",level:2},{value:"Installation and Requirements",id:"installation-and-requirements",level:2},{value:"Using DBOS Agent",id:"using-dbos-agent",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components},{TabItem:i,Tabs:t}=n;return i||p("TabItem",!0),t||p("Tabs",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"use-dbos-with-pydantic-ai",children:"Use DBOS With Pydantic AI"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"https://ai.pydantic.dev/",children:"Pydantic AI"})," is a Python agent framework for building production-grade applications and workflows powered by Generative AI."]}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["Also check out the integration guide in ",(0,a.jsx)(n.a,{href:"https://ai.pydantic.dev/durable_execution/dbos",children:"the Pydantic docs"}),"!"]})}),"\n",(0,a.jsx)(n.p,{children:"This guide shows you how to build a durable AI agent with DBOS and Pydantic AI.\nBy combining the two, you can build reliable agents that preserve progress across transient API failures, application errors, and restarts, while also handling long-running, asynchronous, and human-in-the-loop workflows with production-grade reliability."}),"\n",(0,a.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsx)(n.p,{children:"Pydantic AI has native support for DBOS agents. The diagram below shows the architecture of an agentic application built with DBOS.\nDBOS runs fully in-process as a library: functions remain standard Python functions but are checkpointed to a database for durability."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"                      Clients\n              (HTTP, RPC, Kafka, etc.)\n                          |\n                          v\n  +------------------------------------------------------+\n  |               Application Servers                    |\n  |                                                      |\n  |   +----------------------------------------------+   |\n  |   |        Pydantic AI + DBOS Libraries          |   |\n  |   |                                              |   |\n  |   |  [ Workflows (Agent Run Loop) ]              |   |\n  |   |  [ Steps (Tool, MCP, Model) ]                |   |\n  |   |  [ Queues ]   [ Cron Jobs ]   [ Messaging ]  |   |\n  |   +----------------------------------------------+   |\n  |                                                      |\n  +------------------------------------------------------+\n                          |\n                          v\n  +------------------------------------------------------+\n  |                      Database                        |\n  |   (Stores workflow and step state, schedules tasks)  |\n  +------------------------------------------------------+\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Any Pydantic AI agent can be wrapped in a ",(0,a.jsx)(n.a,{href:"https://ai.pydantic.dev/api/durable_exec/#pydantic_ai.durable_exec.dbos.DBOSAgent",children:(0,a.jsx)(n.code,{children:"DBOSAgent"})})," to enable durable execution. ",(0,a.jsx)(n.code,{children:"DBOSAgent"})," automatically:,"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Wraps ",(0,a.jsx)(n.code,{children:"Agent.run"})," and ",(0,a.jsx)(n.code,{children:"Agent.run_sync"})," (the agent's main loop) as DBOS workflows."]}),"\n",(0,a.jsxs)(n.li,{children:["Wraps ",(0,a.jsx)(n.a,{href:"https://ai.pydantic.dev/models/overview",children:"model requests"})," and ",(0,a.jsx)(n.a,{href:"https://ai.pydantic.dev/mcp/client",children:"MCP communication"})," as DBOS steps."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Custom tool functions and event stream handlers are ",(0,a.jsx)(n.strong,{children:"not automatically wrapped"})," by DBOS.\nYou can decide how to integrate them:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Decorate with ",(0,a.jsx)(n.code,{children:"@DBOS.step"})," if the function involves non-determinism or I/O."]}),"\n",(0,a.jsx)(n.li,{children:"Skip the decorator if durability isn't needed (e.g., debug logging), to avoid the extra DB checkpoint write."}),"\n",(0,a.jsx)(n.li,{children:"If the function needs to enqueue tasks or invoke other DBOS workflows, skip the decorator so it runs inside the agent's main workflow (not as a step)."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"The original agent, model, and MCP server can still be used normally outside the DBOS agent."}),"\n",(0,a.jsx)(n.h2,{id:"installation-and-requirements",children:"Installation and Requirements"}),"\n",(0,a.jsx)(n.p,{children:"Simply install Pydantic AI with the DBOS optional dependency:"}),"\n",(0,a.jsxs)(t,{groupId:"python-package",className:"small-tabs",children:[(0,a.jsx)(i,{value:"pip",label:"pip",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"pip install pydantic-ai[dbos]\n"})})}),(0,a.jsx)(i,{value:"uv",label:"uv",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"uv add pydantic-ai[dbos]\n"})})})]}),"\n",(0,a.jsx)(n.p,{children:"Or if you're using the slim package, you can install it with the DBOS optional dependency:"}),"\n",(0,a.jsxs)(t,{groupId:"python-package",className:"small-tabs",children:[(0,a.jsx)(i,{value:"pip",label:"pip",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"pip install pydantic-ai-slim[dbos]\n"})})}),(0,a.jsx)(i,{value:"uv",label:"uv",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"uv add pydantic-ai-slim[dbos]\n"})})})]}),"\n",(0,a.jsx)(n.h2,{id:"using-dbos-agent",children:"Using DBOS Agent"}),"\n",(0,a.jsx)(n.p,{children:"Here is a simple but complete example of wrapping an agent for durable execution.\nWith fewer than 10 additional lines (highlighted below), you can add DBOS into an existing Pydantic AI application."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",metastring:'{title="dbos_agent.py"}',children:"import asyncio\n# highlight-next-line\nfrom dbos import DBOS, DBOSConfig\n\nfrom pydantic_ai import Agent\n# highlight-next-line\nfrom pydantic_ai.durable_exec.dbos import DBOSAgent\n\n# highlight-start\ndbos_config: DBOSConfig = {\n    'name': 'pydantic_dbos_agent',\n    'system_database_url': 'sqlite:///dbostest.sqlite',\n}\nDBOS(config=dbos_config)\n#highlight-end\n\nagent = Agent(\n    'gpt-5',\n    instructions=\"You're an expert in geography.\",\n    name='geography',\n)\n\n# highlight-next-line\ndbos_agent = DBOSAgent(agent)\n\nasync def main():\n    # highlight-next-line\n    DBOS.launch()\n    result = await dbos_agent.run('What is the capital of Mexico?')\n    print(result.output)\n    #> Mexico City (Ciudad de M\xe9xico, CDMX)\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Notes:"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Workflows and ",(0,a.jsx)(n.code,{children:"DBOSAgent"})," must be defined before ",(0,a.jsx)(n.a,{href:"/python/reference/dbos-class#launch",children:(0,a.jsx)(n.code,{children:"DBOS.launch()"})})," so that recovery can correctly find all workflows."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"https://ai.pydantic.dev/api/durable_exec/#pydantic_ai.durable_exec.dbos.DBOSAgent.run",children:(0,a.jsx)(n.code,{children:"DBOSAgent.run()"})})," works like ",(0,a.jsx)(n.a,{href:"https://ai.pydantic.dev/api/agent/#pydantic_ai.agent.AbstractAgent.run",children:(0,a.jsx)(n.code,{children:"Agent.run()"})}),", but runs as a DBOS workflow and executes model requests, decorated tool calls, and MCP communication as DBOS steps."]}),"\n",(0,a.jsx)(n.li,{children:"This example uses SQLite for simplicity. Postgres is recommended for production."}),"\n",(0,a.jsxs)(n.li,{children:["Each agent must have a unique ",(0,a.jsx)(n.code,{children:"name"}),", which DBOS uses to identify its workflows."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["For more details on building agents, see the ",(0,a.jsx)(n.a,{href:"https://ai.pydantic.dev/durable_execution/dbos",children:"Pydantic AI documentation"}),". For information about durable execution and workflow design, see the ",(0,a.jsx)(n.a,{href:"../python/programming-guide",children:"DBOS programming guide"}),". Together, these resources cover everything from getting started with simple agents to designing production-ready, fault-tolerant applications."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}function p(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>r});var t=i(6540);const a={},s=t.createContext(a);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);