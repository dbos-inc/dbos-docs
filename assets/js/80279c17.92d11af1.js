"use strict";(self.webpackChunkdbos_docs=self.webpackChunkdbos_docs||[]).push([[3942],{3724:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"java/tutorials/queue-tutorial","title":"Queues & Concurrency","description":"You can use queues to run many workflows at once with managed concurrency.","source":"@site/docs/java/tutorials/queue-tutorial.md","sourceDirName":"java/tutorials","slug":"/java/tutorials/queue-tutorial","permalink":"/java/tutorials/queue-tutorial","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":30,"frontMatter":{"sidebar_position":30,"title":"Queues & Concurrency","toc_max_heading_level":3},"sidebar":"tutorialSidebar","previous":{"title":"Steps","permalink":"/java/tutorials/step-tutorial"},"next":{"title":"Communicating with Workflows","permalink":"/java/tutorials/workflow-communication"}}');var o=t(4848),s=t(8453);const i={sidebar_position:30,title:"Queues & Concurrency",toc_max_heading_level:3},a=void 0,u={},l=[{value:"Queue Example",id:"queue-example",level:2},{value:"Enqueueing from Another Application",id:"enqueueing-from-another-application",level:2},{value:"Managing Concurrency",id:"managing-concurrency",level:2},{value:"Worker Concurrency",id:"worker-concurrency",level:3},{value:"Global Concurrency",id:"global-concurrency",level:3},{value:"Rate Limiting",id:"rate-limiting",level:2},{value:"Setting Timeouts",id:"setting-timeouts",level:2},{value:"Partitioning Queues",id:"partitioning-queues",level:2},{value:"Deduplication",id:"deduplication",level:2},{value:"Priority",id:"priority",level:2},{value:"Explicit Queue Listening",id:"explicit-queue-listening",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["You can use queues to run many workflows at once with managed concurrency.\nQueues provide ",(0,o.jsx)(n.em,{children:"flow control"}),", letting you manage how many workflows run at once or how often workflows are started."]}),"\n",(0,o.jsxs)(n.p,{children:["To create a queue, instantiate and register a ",(0,o.jsx)(n.a,{href:"/java/reference/queues#queue",children:(0,o.jsx)(n.code,{children:"Queue"})})," object.\nAll queues must be created and registered before DBOS is launched."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'Queue queue = new Queue("example-queue");\nDBOS.registerQueue(queue);\n'})}),"\n",(0,o.jsxs)(n.p,{children:["You can then enqueue any workflow using ",(0,o.jsx)(n.a,{href:"/java/reference/workflows-steps#startworkflow",children:(0,o.jsx)(n.code,{children:"withQueue"})})," when calling ",(0,o.jsx)(n.code,{children:"startWorkflow"}),".\nEnqueuing a workflow submits it for execution and returns a ",(0,o.jsx)(n.a,{href:"/java/reference/workflows-steps#workflowhandle",children:"handle"})," to it.\nQueued tasks are started in first-in, first-out (FIFO) order."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'class ExampleImpl implements Example {\n    @Workflow\n    public String processTask(String task) {\n        // Process the task...\n        return "Processed: " + task;\n    }\n}\n\npublic String example(Queue queue, Example proxy, String task) throws Exception {\n    // Enqueue a workflow\n    WorkflowHandle<String, Exception> handle = DBOS.startWorkflow(\n        () -> proxy.processTask(task),\n        new StartWorkflowOptions().withQueue(queue)\n    );\n\n    // Get the result\n    String result = handle.getResult();\n    System.out.println("Task result: " + result);\n    return result;\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"queue-example",children:"Queue Example"}),"\n",(0,o.jsx)(n.p,{children:"Here's an example of a workflow using a queue to process tasks concurrently:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'interface Example {\n    public void setProxy(Example proxy);\n    public String taskWorkflow(String task);\n    public List<String> queueWorkflow(String[] tasks) throws Exception;\n}\n\nclass ExampleImpl implements Example {\n\n    private final Queue queue;\n    private Example proxy;\n\n    public ExampleImpl(Queue queue) {\n        this.queue = queue;\n    }\n\n    public void setProxy(Example proxy) {\n        this.proxy = proxy;\n    }\n\n    @Workflow\n    public String taskWorkflow(String task) {\n        // Process the task...\n        return "Processed: " + task;\n    }\n\n    @Workflow\n    public List<String> queueWorkflow(String[] tasks) throws Exception {\n        // Enqueue each task so all tasks are processed concurrently\n        List<WorkflowHandle<String, Exception>> handles = new ArrayList<>();\n        for (String task : tasks) {\n            WorkflowHandle<String, Exception> handle = DBOS.startWorkflow(\n                () -> proxy.taskWorkflow(task),\n                new StartWorkflowOptions().withQueue(queue)\n            );\n            handles.add(handle);\n        }\n\n        // Wait for each task to complete and retrieve its result\n        List<String> results = new ArrayList<>();\n        for (WorkflowHandle<String, Exception> handle : handles) {\n            String result = handle.getResult();\n            results.add(result);\n        }\n\n        return results;\n    }\n}\n\npublic class App {\n    public static void main(String[] args) throws Exception {\n        DBOSConfig config = ...\n        DBOS.configure(config);\n\n        // Create and register a queue\n        Queue queue = new Queue("example-queue");\n        DBOS.registerQueue(queue);\n        // Instantiate an Example and register its workflows\n        ExampleImpl impl = new ExampleImpl(queue);\n        Example proxy = DBOS.registerWorkflows(Example.class, impl);\n        // Provide the workflow proxy to the class so its methods can invoke workflows\n        impl.setProxy(proxy);\n\n        DBOS.launch();\n\n        // Run the queue workflow\n        String[] tasks = {"task1", "task2", "task3", "task4", "task5"};\n        List<String> results = proxy.queueWorkflow(tasks);\n        for (String result : results) {\n            System.out.println(result);\n        }\n    }\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Sometimes, you may wish to receive the result of each task as soon as it's ready instead of waiting for all tasks to complete.\nYou can do this using ",(0,o.jsxs)(n.a,{href:"/java/tutorials/workflow-communication#workflow-messaging-and-notifications",children:[(0,o.jsx)(n.code,{children:"send"})," and ",(0,o.jsx)(n.code,{children:"recv"})]}),".\nEach enqueued workflow sends a message to the main workflow when it's done processing its task.\nThe main workflow awaits those messages, retrieving the result of each task as soon as the task completes."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'interface Example {\n    public void setProxy(Example proxy);\n    public String processTask(String parentWorkflowId, int taskId, String task);\n    public List<String> processTasks(String[] tasks) throws Exception;\n}\n\nclass ExampleImpl implements Example {\n    private static final String TASK_COMPLETE_TOPIC = "task_complete";\n\n    private final Queue queue;\n    private Example proxy;\n\n    public ExampleImpl(Queue queue) {\n        this.queue = queue;\n    }\n\n    public void setProxy(Example proxy) {\n        this.proxy = proxy;\n    }\n\n    @Workflow(name = "processTask")\n    public String processTask(String parentWorkflowId, int taskId, String task) {\n        String result = "Processed: " + task; // Process the task\n\n        // Notify the main workflow this task is complete\n        DBOS.send(parentWorkflowId, taskId, TASK_COMPLETE_TOPIC);\n        return result;\n    }\n\n    @Workflow(name = "processTasks")\n    public List<String> processTasks(String[] tasks) throws Exception {\n        String parentWorkflowId = DBOS.workflowId();\n\n        List<WorkflowHandle<String, Exception>> handles = new ArrayList<>();\n        for (int i = 0; i < tasks.length; i++) {\n            final int taskId = i;\n            final String task = tasks[i];\n            WorkflowHandle<String, Exception> handle = DBOS.startWorkflow(\n                () -> proxy.processTask(parentWorkflowId, taskId, task),\n                new StartWorkflowOptions().withQueue(queue)\n            );\n            handles.add(handle);\n        }\n\n        List<String> results = new ArrayList<>();\n        while (results.size() < tasks.length) {\n            // Wait for a notification that a task is complete\n            Integer completedTaskId = (Integer) DBOS.recv(TASK_COMPLETE_TOPIC, Duration.ofMinutes(5));\n            if (completedTaskId == null) {\n                throw new RuntimeException("Timeout waiting for task completion");\n            }\n            // Retrieve result of the completed task\n            WorkflowHandle<String, Exception> completedTaskHandle = handles.get(completedTaskId);\n            String result = completedTaskHandle.getResult();\n            System.out.println("Task " + completedTaskId + " completed. Result: " + result);\n            results.add(result);\n        }\n        return results;\n    }\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"enqueueing-from-another-application",children:"Enqueueing from Another Application"}),"\n",(0,o.jsx)(n.p,{children:"Often, you want to enqueue a workflow from outside your DBOS application.\nFor example, let's say you have an API server and a data processing service.\nYou're using DBOS to build a durable data pipeline in the data processing service.\nWhen the API server receives a request, it should enqueue the data pipeline for execution on the data processing service."}),"\n",(0,o.jsxs)(n.p,{children:["You can use the ",(0,o.jsx)(n.a,{href:"/java/reference/client",children:"DBOS Client"})," to enqueue workflows from outside your DBOS application by connecting directly to your DBOS application's system database.\nSince the DBOS Client is designed to be used from outside your DBOS application, workflow and queue metadata must be specified explicitly."]}),"\n",(0,o.jsxs)(n.p,{children:["For example, this code enqueues the ",(0,o.jsx)(n.code,{children:"dataPipeline"})," workflow on the ",(0,o.jsx)(n.code,{children:"pipelineQueue"})," queue with arguments:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'var client = new DBOSClient(dbUrl, dbUser, dbPassword);\n\nvar options = new DBOSClient.EnqueueOptions(\n    "com.example.DataPipelineImpl",  // Class name\n    "dataPipeline",                  // Workflow name\n    "pipelineQueue"                  // Queue name\n);\n\nvar handle = client.enqueueWorkflow(\n    options,\n    new Object[]{"task-123", "data"}  // Workflow arguments\n);\n\n// Optionally wait for the result\nObject result = handle.getResult();\n'})}),"\n",(0,o.jsx)(n.h2,{id:"managing-concurrency",children:"Managing Concurrency"}),"\n",(0,o.jsx)(n.p,{children:"You can control how many workflows from a queue run simultaneously by configuring concurrency limits.\nThis helps prevent resource exhaustion when workflows consume significant memory or processing power."}),"\n",(0,o.jsx)(n.h3,{id:"worker-concurrency",children:"Worker Concurrency"}),"\n",(0,o.jsx)(n.p,{children:"Worker concurrency sets the maximum number of workflows from a queue that can run concurrently on a single DBOS process.\nThis is particularly useful for resource-intensive workflows to avoid exhausting the resources of any process.\nFor example, this queue has a worker concurrency of 5, so each process will run at most 5 workflows from this queue simultaneously:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'Queue queue = new Queue("example-queue")\n    .withWorkerConcurrency(5);\nDBOS.registerQueue(queue);\n'})}),"\n",(0,o.jsx)(n.h3,{id:"global-concurrency",children:"Global Concurrency"}),"\n",(0,o.jsx)(n.p,{children:"Global concurrency limits the total number of workflows from a queue that can run concurrently across all DBOS processes in your application.\nFor example, this queue will have a maximum of 10 workflows running simultaneously across your entire application."}),"\n",(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsxs)(n.p,{children:["Worker concurrency limits are recommended for most use cases.\nTake care when using a global concurrency limit as any ",(0,o.jsx)(n.code,{children:"PENDING"})," workflow on the queue counts toward the limit, including workflows from previous application versions."]})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'Queue queue = new Queue("example-queue")\n    .withConcurrency(10);\nDBOS.registerQueue(queue);\n'})}),"\n",(0,o.jsx)(n.h2,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,o.jsxs)(n.p,{children:["You can set ",(0,o.jsx)(n.em,{children:"rate limits"})," for a queue, limiting the number of workflows that it can start in a given period.\nRate limits are global across all DBOS processes using this queue.\nFor example, this queue has a limit of 100 workflows with a period of 60 seconds, so it may not start more than 100 workflows in 60 seconds:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'Queue queue = new Queue("example-queue")\n    .withRateLimit(100, 60.0);  // 100 workflows per 60 seconds\nDBOS.registerQueue(queue);\n'})}),"\n",(0,o.jsx)(n.p,{children:"Rate limits are especially useful when working with a rate-limited API."}),"\n",(0,o.jsx)(n.h2,{id:"setting-timeouts",children:"Setting Timeouts"}),"\n",(0,o.jsxs)(n.p,{children:["You can set a timeout for an enqueued workflow via the ",(0,o.jsx)(n.code,{children:"withTimeout"})," function on ",(0,o.jsx)(n.code,{children:"WorkflowOptions"})," and ",(0,o.jsx)(n.code,{children:"StartWorkflowOptions"}),".\nWhen the timeout expires, the workflow ",(0,o.jsx)(n.strong,{children:"and all its children"})," are cancelled.\nCancelling a workflow sets its status to ",(0,o.jsx)(n.code,{children:"CANCELLED"})," and preempts its execution at the beginning of its next step."]}),"\n",(0,o.jsxs)(n.p,{children:["Timeouts are ",(0,o.jsx)(n.strong,{children:"start-to-completion"}),": a workflow's timeout does not begin until the workflow is dequeued and starts execution.\nAlso, timeouts are ",(0,o.jsx)(n.strong,{children:"durable"}),": they are stored in the database and persist across restarts, so workflows can have very long timeouts."]}),"\n",(0,o.jsx)(n.p,{children:"Example syntax:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'Queue queue = new Queue("example-queue");\nDBOS.registerQueue(queue);\n\n// use StartWorkflowOptions.withTimeout with DBOS.startWorkflow\nvar options = new StartWorkflowOptions(queue).withTimeout(Duration.ofSeconds(10))\nvar handle = DBOS.startWorkflow(() -> proxy.workflow(), options);\n'})}),"\n",(0,o.jsx)(n.h2,{id:"partitioning-queues",children:"Partitioning Queues"}),"\n",(0,o.jsxs)(n.p,{children:["You can ",(0,o.jsx)(n.strong,{children:"partition"}),' queues to distribute work across dynamically created queue partitions.\nWhen you enqueue a workflow on a partitioned queue, you must supply a queue partition key.\nPartitioned queues dequeue workflows and apply flow control limits for individual partitions, not for the entire queue.\nEssentially, you can think of each partition as a "subqueue" you dynamically create by enqueueing a workflow with a partition key.']}),"\n",(0,o.jsx)(n.p,{children:"For example, suppose you want your users to each be able to run at most one task at a time.\nYou can do this with a partitioned queue with a maximum concurrency limit of 1 where the partition key is user ID."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Example Syntax"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'Queue queue = new Queue("example-queue").withConcurrency(1).withPartitionedEnabled(true);\nDBOS.registerQueue(queue);\n\nvoid onUserTaskSubmission(String userID, Task task) {\n    // Partition the task queue by user ID. As the queue has a\n    // maximum concurrency of 1, this means that at most one\n    // task can run at once per user (but tasks from different\n    // users can run concurrently).\n    var options = new StartWorkflowOptions(queue).withQueuePartitionKey(userID);\n    DBOS.startWorkflow(() -> taskWorkflow(task), options);\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Sometimes, you want to apply global or per-worker limits to a partitioned queue.\nYou can do this with ",(0,o.jsx)(n.strong,{children:"multiple levels of queueing"}),'.\nCreate two queues: a partitioned queue with per-partition limits and a non-partitioned queue with global limits.\nEnqueue a "concurrency manager" workflow to the partitioned queue, which then enqueues your actual workflow\nto the non-partitioned queue and awaits its result.\nThis ensures both queues\' flow control limits are enforced on your workflow.\nFor example:']}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'// By using two levels of queueing, we enforce both a concurrency limit of 1 on each partition\n// and a global concurrency limit of 5, meaning that no more than 5 tasks can run concurrently\n// across all partitions (and at most one task per partition).\nvar partitionedQueue = new Queue("partitioned-queue").withConcurrency(1).withPartitionedEnabled(true);\nvar concurrencyQueue = new Queue("concurrency-queue").withConcurrency(5);\n\nclass UserTasksImpl implements UserTasks {\n\n    // proxy object gets injected to implementation object to enable intra-workflow invocation  \n    UserTasks proxy;\n\n    @Workflow\n    void onUserTaskSubmission(String userID, Task task) {\n        // First, enqueue a "concurrency manager" workflow to the partitioned\n        // queue to enforce per-partition limits.\n        var options = new StartWorkflowOptions(partitionedQueue).withQueuePartitionKey(userID);\n        DBOS.startWorkflow(() -> proxy.concurrencyManager(task), options);\n    }\n\n    @Workflow\n    String concurrencyManager(Task task) {\n        // The "concurrency manager" workflow enqueues the processTask\n        // workflow on the non-partitioned queue and awaits its results\n        // to enforce global flow control limits.\n        var options = new StartWorkflowOptions(concurrencyQueue);\n        var handle = DBOS.startWorkflow(() -> proxy.processTask(task), options);\n        return handle.getResult();\n    }\n\n    @Workflow\n    String processTask(Task task) {\n        // task processing code\n    }\n'})}),"\n",(0,o.jsx)(n.h2,{id:"deduplication",children:"Deduplication"}),"\n",(0,o.jsxs)(n.p,{children:["You can set a deduplication ID for an enqueued workflow using ",(0,o.jsx)(n.a,{href:"/java/reference/workflows-steps#startworkflow",children:(0,o.jsx)(n.code,{children:"withQueue"})})," when calling ",(0,o.jsx)(n.code,{children:"startWorkflow"}),".\nAt any given time, only one workflow with a specific deduplication ID can be enqueued in the specified queue.\nIf a workflow with a deduplication ID is currently enqueued or actively executing (status ",(0,o.jsx)(n.code,{children:"ENQUEUED"})," or ",(0,o.jsx)(n.code,{children:"PENDING"}),"), subsequent workflow enqueue attempts with the same deduplication ID in the same queue will raise an exception."]}),"\n",(0,o.jsx)(n.p,{children:"For example, this is useful if you only want to have one workflow active at a time per user\u2014set the deduplication ID to the user's ID."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Example syntax:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'@Workflow(name = "taskWorkflow")\npublic String taskWorkflow(String task) {\n    // Process the task...\n    return "completed";\n}\n\npublic void example(Example proxy, String task, String userID) throws Exception {\n    // Use user ID for deduplication\n    WorkflowHandle<String, Exception> handle = DBOS.startWorkflow(\n        () -> proxy.taskWorkflow(task),\n        new StartWorkflowOptions().withQueue(queue).withDeduplicationId(userID)\n    );\n\n    String result = handle.getResult();\n    System.out.println("Workflow completed: " + result);\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"priority",children:"Priority"}),"\n",(0,o.jsxs)(n.p,{children:["You can set a priority for an enqueued workflow using ",(0,o.jsx)(n.a,{href:"/java/reference/workflows-steps#startworkflow",children:(0,o.jsx)(n.code,{children:"withQueue"})})," when calling ",(0,o.jsx)(n.code,{children:"startWorkflow"}),".\nWorkflows with the same priority are dequeued in ",(0,o.jsx)(n.strong,{children:"FIFO (first in, first out)"})," order. Priority values can range from ",(0,o.jsx)(n.code,{children:"1"})," to ",(0,o.jsx)(n.code,{children:"2,147,483,647"}),", where ",(0,o.jsx)(n.strong,{children:"a low number indicates a higher priority"}),".\nIf using priority, you must set ",(0,o.jsx)(n.a,{href:"/java/reference/queues#queue",children:(0,o.jsx)(n.code,{children:"priorityEnabled"})})," on your queue."]}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsx)(n.p,{children:"Workflows without assigned priorities have the highest priority and are dequeued before workflows with assigned priorities."})}),"\n",(0,o.jsx)(n.p,{children:"To use priorities in a queue, you must enable it when creating the queue:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'Queue queue = new Queue("example-queue")\n    .withPriorityEnabled(true);\nDBOS.registerQueue(queue);\n'})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Example syntax:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'@Workflow(name = "taskWorkflow")\npublic String taskWorkflow(String task) {\n    // Process the task...\n    return "completed";\n}\n\npublic void example(Example proxy, String task, int priority) throws Exception {\n    WorkflowHandle<String, Exception> handle = DBOS.startWorkflow(\n        () -> proxy.taskWorkflow(task),\n        new StartWorkflowOptions().withQueue(queue).withPriority(priority)\n    );\n\n    String result = handle.getResult();\n    System.out.println("Workflow completed: " + result);\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"explicit-queue-listening",children:"Explicit Queue Listening"}),"\n",(0,o.jsxs)(n.p,{children:["By default, a process running DBOS listens to (dequeues workflows from) all declared queues.\nHowever, sometimes you only want a process to listen to a specific list of queues.\nYou use the ",(0,o.jsx)(n.code,{children:"withListenQueues"})," method on ",(0,o.jsx)(n.a,{href:"/java/reference/lifecycle#dbosconfigure",children:"DBOSConfig"})," to explicitly tell a process running DBOS to only listen to a specific set of queues."]}),"\n",(0,o.jsx)(n.p,{children:"This is particularly useful when managing heterogeneous workers, where specific tasks should execute on specific physical servers.\nFor example, say you have a mix of CPU workers and GPU workers and you want CPU tasks to only execute on CPU workers and GPU tasks to only execute on GPU workers.\nYou can create separate queues for CPU and GPU tasks and configure each type of worker to only listen to the appropriate queue:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-java",children:'public class DBOSLifecycle implements SmartLifecycle {\n\n    @Override\n    public void start() {\n\n        var cpuQueue = new Queue("cpuQueue");\n        DBOS.registerQueue(cpuQueue);\n        var gpuQueue = new Queue("gpuQueue");\n        DBOS.registerQueue(gpuQueue);\n\n        var workerType = System.getenv("WORKER_TYPE"); // "cpu" or "gpu"\n        var config = DBOSConfig.defaults("my-dbos-app");\n        if (workerType.equals("gpu")) {\n            config = config.withListenQueues(gpuQueue);\n        } else if (workerType.equals("cpu")) {\n            config = config.withListenQueues(cpuQueue);\n        }\n        DBOS.configure(config);\n        DBOS.launch();\n    }\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Note that ",(0,o.jsx)(n.code,{children:"withListenQueues"})," only controls what workflows are dequeued, not what workflows can be enqueued, so you can freely enqueue tasks onto the GPU queue from a CPU worker for execution on a GPU worker, and vice versa."]})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var r=t(6540);const o={},s=r.createContext(o);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);