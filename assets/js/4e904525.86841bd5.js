"use strict";(self.webpackChunkdbos_docs=self.webpackChunkdbos_docs||[]).push([[8107],{3870:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>p});const o=JSON.parse('{"id":"production/hosting-with-docker","title":"Deploying With Docker","description":"This guide shows you how to setup a DBOS application and its Postgres database using Docker.","source":"@site/docs/production/hosting-with-docker.md","sourceDirName":"production","slug":"/production/hosting-with-docker","permalink":"/production/hosting-with-docker","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":69,"frontMatter":{"sidebar_position":69,"title":"Deploying With Docker"},"sidebar":"tutorialSidebar","previous":{"title":"DBOS MCP Server","permalink":"/production/mcp"},"next":{"title":"Deploying With Kubernetes","permalink":"/production/hosting-with-kubernetes"}}');var s=t(4848),i=t(8453);const r={sidebar_position:69,title:"Deploying With Docker"},a=void 0,c={},p=[{value:"Dockerfile",id:"dockerfile",level:2},{value:"Docker Compose",id:"docker-compose",level:2},{value:"Access the application",id:"access-the-application",level:2}];function l(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"This guide shows you how to setup a DBOS application and its Postgres database using Docker."}),"\n",(0,s.jsx)(n.h2,{id:"dockerfile",children:"Dockerfile"}),"\n",(0,s.jsx)(n.p,{children:"In this example, we'll use a DBOS Python application.\nFirst, we'll setup a Dockerfile to configure a Debian Python image."}),"\n",(0,s.jsx)(n.p,{children:"There's nothing unique about this Dockerfile\u2014DBOS is just a library for your program to import, so it can run in any Docker container.\nThe container initializes a DBOS starter template then starts the application."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'FROM python:3.11-slim\n\nWORKDIR /app\n\nRUN python3 -m venv .venv && \\\n    . .venv/bin/activate && \\\n    pip install --upgrade pip && \\\n    pip install dbos && \\\n    dbos init --template dbos-app-starter\n\nEXPOSE 8000\n\nCMD ["/bin/bash", "-c", ". .venv/bin/activate && dbos start"]\n'})}),"\n",(0,s.jsx)(n.h2,{id:"docker-compose",children:"Docker Compose"}),"\n",(0,s.jsxs)(n.p,{children:["Next, we'll use Docker compose to start two containers: one for Postgres and one for the DBOS Python app.\nNote we set ",(0,s.jsx)(n.code,{children:"restart"})," to ",(0,s.jsx)(n.code,{children:"unless-stopped"})," so the container automatically restarts if the application crashes."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'version: \'3.9\'\n\nservices:\n  db:\n    image: pgvector/pgvector:pg16\n    environment:\n      POSTGRES_USER: postgres\n      POSTGRES_PASSWORD: dbos\n    ports:\n      - "5432:5432"\n    volumes:\n      - pgdata:/var/lib/postgresql/data\n\n  app:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    ports:\n      - "8000:8000"\n    depends_on:\n      - db\n    environment:\n      DBOS_SYSTEM_DATABASE_URL: postgres://postgres:dbos@db:5432/dbos_app_starter\n    restart: unless-stopped\n\nvolumes:\n  pgdata:\n'})}),"\n",(0,s.jsx)(n.h2,{id:"access-the-application",children:"Access the application"}),"\n",(0,s.jsxs)(n.p,{children:["Bring the containers up with ",(0,s.jsx)(n.code,{children:"docker-compose up --build"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["You can now visit ",(0,s.jsx)(n.code,{children:"http://localhost:8000/"}),' to see the template application live.\nIf you press "crash the application", Docker will restart the container immediately and the DBOS workflow will resume durably.']})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var o=t(6540);const s={},i=o.createContext(s);function r(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);