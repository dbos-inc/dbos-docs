"use strict";(self.webpackChunkdbos_docs=self.webpackChunkdbos_docs||[]).push([[5968],{8362:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>a,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"typescript/tutorials/integrating-dbos","title":"Adding DBOS To Your App","description":"This guide shows you how to add the open source DBOS Transact library to your existing application to durably execute it and make it resilient to any failure.","source":"@site/docs/typescript/tutorials/integrating-dbos.md","sourceDirName":"typescript/tutorials","slug":"/typescript/tutorials/integrating-dbos","permalink":"/typescript/tutorials/integrating-dbos","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":100,"frontMatter":{"sidebar_position":100,"title":"Adding DBOS To Your App","pagination_next":null},"sidebar":"tutorialSidebar","previous":{"title":"Using Instantiated Objects","permalink":"/typescript/tutorials/instantiated-objects"}}');var i=t(4848),s=t(8453);const a={sidebar_position:100,title:"Adding DBOS To Your App",pagination_next:null},r=void 0,l={},d=[{value:"Using DBOS Transact",id:"using-dbos-transact",level:3},{value:"1. Install DBOS",id:"1-install-dbos",level:4},{value:"2. Initialize DBOS in Your App",id:"2-initialize-dbos-in-your-app",level:4},{value:"3. Start Your Application",id:"3-start-your-application",level:4},{value:"4. Start Building With DBOS",id:"4-start-building-with-dbos",level:4},{value:"Deploying to DBOS Cloud",id:"deploying-to-dbos-cloud",level:3},{value:"1. Install the DBOS Cloud CLI",id:"1-install-the-dbos-cloud-cli",level:4},{value:"2. Define a Start Command",id:"2-define-a-start-command",level:4},{value:"3. Deploy to DBOS Cloud",id:"3-deploy-to-dbos-cloud",level:4}];function c(e){const n={a:"a",code:"code",h3:"h3",h4:"h4",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["This guide shows you how to add the open source ",(0,i.jsx)(n.a,{href:"https://github.com/dbos-inc/dbos-transact-ts",children:"DBOS Transact"})," library to your existing application to ",(0,i.jsx)(n.strong,{children:"durably execute"})," it and make it resilient to any failure.\nIt also shows you how to serverlessly deploy your application to DBOS Cloud and scale it to millions of users."]}),"\n",(0,i.jsx)(n.h3,{id:"using-dbos-transact",children:"Using DBOS Transact"}),"\n",(0,i.jsx)(n.h4,{id:"1-install-dbos",children:"1. Install DBOS"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"npm install"})," DBOS into your application. Note that DBOS requires Node.js 20 or later."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"npm install @dbos-inc/dbos-sdk\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Then, create a ",(0,i.jsx)(n.code,{children:"dbos-config.yaml"})," file in your app's root directory:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="dbos-config.yaml"',children:"# yaml-language-server: $schema=https://raw.githubusercontent.com/dbos-inc/dbos-transact-ts/main/dbos-config.schema.json\n\nlanguage: node\ntelemetry:\n  logs:\n    logLevel: 'info'\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Also, set the following settings in your ",(0,i.jsx)(n.code,{children:"tsconfig.json"})," file, which enable TypeScript decorators:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="tsconfig.json"',children:'  "compilerOptions": {\n    "experimentalDecorators": true,\n    "emitDecoratorMetadata": true,\n  }\n'})}),"\n",(0,i.jsx)(n.h4,{id:"2-initialize-dbos-in-your-app",children:"2. Initialize DBOS in Your App"}),"\n",(0,i.jsx)(n.p,{children:"In your app's main entrypoint, add the following lines of code.\nThis initializes DBOS when your app starts."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'import { DBOS } from "@dbos-inc/dbos-sdk";\n\nawait DBOS.launch();\n'})}),"\n",(0,i.jsx)(n.h4,{id:"3-start-your-application",children:"3. Start Your Application"}),"\n",(0,i.jsx)(n.p,{children:"Try starting your application:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"npm start # Or use your own start command\n"})}),"\n",(0,i.jsxs)(n.p,{children:["When ",(0,i.jsx)(n.a,{href:"../reference/transactapi/dbos-class#launching-dbos",children:(0,i.jsx)(n.code,{children:"await DBOS.launch()"})})," is called, it will attempt to connect to a Postgres database.\nIf your project is already using Postgres, add the connection information for your database to ",(0,i.jsx)(n.a,{href:"../reference/configuration#database",children:(0,i.jsx)(n.code,{children:"dbos-config.yaml"})}),".\nOtherwise, DBOS will automatically guide you through launching a new database and connecting to it."]}),"\n",(0,i.jsxs)(n.p,{children:["After you've connected to Postgres, your app should run normally, but log ",(0,i.jsx)(n.code,{children:" Workflow executor initialized"})," and ",(0,i.jsx)(n.code,{children:"DBOS Admin Server is running at..."})," on startup.\nCongratulations!  You've integrated DBOS into your application."]}),"\n",(0,i.jsx)(n.h4,{id:"4-start-building-with-dbos",children:"4. Start Building With DBOS"}),"\n",(0,i.jsxs)(n.p,{children:["At this point, you can add any DBOS decorator or method to your application.\nFor example, you can annotate one of your functions as a ",(0,i.jsx)(n.a,{href:"/typescript/tutorials/workflow-tutorial",children:"workflow"})," and the functions it calls as ",(0,i.jsx)(n.a,{href:"/typescript/tutorials/step-tutorial",children:"steps"}),".\nDBOS durably executes the workflow so if it is ever interrupted, upon restart it automatically recovers to the last completed step."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"export class Example {\n\n  @DBOS.step()\n  static async myStep(n) {\n    DBOS.logger.info(`Step ${n} completed!`);\n  }\n\n  @DBOS.workflow()\n  static async exampleWorkflow() {\n    await Example.myStep(1);\n    await Example.myStep(2);\n  }\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["To ensure that DBOS registers all decorated functions, ",(0,i.jsxs)(n.strong,{children:["declare all DBOS-decorated functions before running ",(0,i.jsx)(n.code,{children:"await DBOS.launch()"}),"."]})]}),"\n",(0,i.jsx)(n.p,{children:"You can add DBOS to your application incrementally\u2014it won't interfere with code that's already there.\nIt's totally okay for your application to have one DBOS workflow alongside thousands of lines of non-DBOS code."}),"\n",(0,i.jsxs)(n.p,{children:["To learn more about programming with DBOS, check out ",(0,i.jsx)(n.a,{href:"/typescript/programming-guide",children:"the programming guide"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"deploying-to-dbos-cloud",children:"Deploying to DBOS Cloud"}),"\n",(0,i.jsx)(n.p,{children:"Any application you build with DBOS can be serverlessly deployed to DBOS Cloud.\nDBOS Cloud can seamlessly autoscale your application to millions of users and provides built-in dashboards for observability and monitoring."}),"\n",(0,i.jsx)(n.h4,{id:"1-install-the-dbos-cloud-cli",children:"1. Install the DBOS Cloud CLI"}),"\n",(0,i.jsx)(n.p,{children:"Run this command to install the cloud CLI globally."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"npm i -g @dbos-inc/dbos-cloud@latest\n"})}),"\n",(0,i.jsx)(n.h4,{id:"2-define-a-start-command",children:"2. Define a Start Command"}),"\n",(0,i.jsxs)(n.p,{children:["Set the ",(0,i.jsx)(n.code,{children:"start"})," command in the ",(0,i.jsx)(n.code,{children:"runtimeConfig"})," section of your ",(0,i.jsx)(n.a,{href:"/typescript/reference/configuration",children:(0,i.jsx)(n.code,{children:"dbos-config.yaml"})})," to your application's launch command."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="dbos-config.yaml"',children:"runtimeConfig:\n  start:\n    - npm start\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If your application includes an HTTP server, configure it to listen on port 3000.\nTo test that it works, try launching your application with ",(0,i.jsx)(n.code,{children:"npx dbos start"}),"."]}),"\n",(0,i.jsx)(n.h4,{id:"3-deploy-to-dbos-cloud",children:"3. Deploy to DBOS Cloud"}),"\n",(0,i.jsx)(n.p,{children:"Run this single command to deploy your application to DBOS Cloud!"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"dbos-cloud app deploy\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var o=t(6540);const i={},s=o.createContext(i);function a(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);