"use strict";(self.webpackChunkdbos_docs=self.webpackChunkdbos_docs||[]).push([[5943],{2161:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"production/self-hosting/hosting-with-docker","title":"Deploying With Docker","description":"This guide shows you how to setup a starter DBOS Python application and its Postgres database using Docker.","source":"@site/docs/production/self-hosting/hosting-with-docker.md","sourceDirName":"production/self-hosting","slug":"/production/self-hosting/hosting-with-docker","permalink":"/production/self-hosting/hosting-with-docker","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":69,"frontMatter":{"sidebar_position":69,"title":"Deploying With Docker"},"sidebar":"tutorialSidebar","previous":{"title":"Workflow Recovery","permalink":"/production/self-hosting/workflow-recovery"},"next":{"title":"Deploying With Kubernetes","permalink":"/production/self-hosting/hosting-with-kubernetes"}}');var s=n(4848),i=n(8453);const r={sidebar_position:69,title:"Deploying With Docker"},a="Deploying with Docker",c={},l=[{value:"Dockerfile",id:"dockerfile",level:2},{value:"Docker compose",id:"docker-compose",level:2},{value:"Access the application",id:"access-the-application",level:2}];function p(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"deploying-with-docker",children:"Deploying with Docker"})}),"\n",(0,s.jsx)(t.p,{children:"This guide shows you how to setup a starter DBOS Python application and its Postgres database using Docker."}),"\n",(0,s.jsx)(t.h2,{id:"dockerfile",children:"Dockerfile"}),"\n",(0,s.jsx)(t.p,{children:"First, we'll setup a Dockerfile to configure a Debian Python image."}),"\n",(0,s.jsx)(t.p,{children:"There's nothing unique about this Dockerfile\u2014DBOS is just a library for your program to import, so it can run in any Docker container that has the appropriate language runtime (Node or Python) installed.\nThe container initializes a DBOS starter template then starts the application."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'FROM python:3.11-slim\n\nWORKDIR /app\n\nRUN python3 -m venv .venv && \\\n    . .venv/bin/activate && \\\n    pip install --upgrade pip && \\\n    pip install dbos && \\\n    dbos init --template dbos-app-starter\n\nEXPOSE 8000\n\nCMD ["/bin/bash", "-c", ". .venv/bin/activate && dbos start"]\n'})}),"\n",(0,s.jsx)(t.h2,{id:"docker-compose",children:"Docker compose"}),"\n",(0,s.jsxs)(t.p,{children:["Next, we'll use Docker compose to start two containers: one for Postgres and one for the DBOS Python app.\nNote we set ",(0,s.jsx)(t.code,{children:"restart"})," to ",(0,s.jsx)(t.code,{children:"unless-stopped"})," so the container automatically restarts if the application crashes."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:'version: \'3.9\'\n\nservices:\n  db:\n    image: pgvector/pgvector:pg16\n    environment:\n      POSTGRES_USER: postgres\n      POSTGRES_PASSWORD: dbos\n    ports:\n      - "5432:5432"\n    volumes:\n      - pgdata:/var/lib/postgresql/data\n\n  app:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    ports:\n      - "8000:8000"\n    depends_on:\n      - db\n    environment:\n      DBOS_DATABASE_URL: postgres://postgres:dbos@db:5432/dbos_app_starter\n    restart: unless-stopped\n\nvolumes:\n  pgdata:\n'})}),"\n",(0,s.jsx)(t.h2,{id:"access-the-application",children:"Access the application"}),"\n",(0,s.jsxs)(t.p,{children:["Bring the containers up with ",(0,s.jsx)(t.code,{children:"docker-compose up --build"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["You can now visit ",(0,s.jsx)(t.code,{children:"http://localhost:8000/"}),' to see the template application live.\nIf you press "crash the application", Docker will restart the container immediately and the DBOS workflow will resume durably.']})]})}function d(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>a});var o=n(6540);const s={},i=o.createContext(s);function r(e){const t=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(i.Provider,{value:t},e.children)}}}]);