"use strict";(self.webpackChunkdbos_docs=self.webpackChunkdbos_docs||[]).push([[904],{2275:(e,n,s)=>{s.d(n,{Ay:()=>a,RM:()=>l});var o=s(4848),t=s(8453);const l=[];function r(e){const n={a:"a",code:"code",p:"p",pre:"pre",...(0,t.R)(),...e.components},{TabItem:s,Tabs:l}=n;return s||i("TabItem",!0),l||i("Tabs",!0),(0,o.jsxs)(l,{groupId:"operating-systems",className:"small-tabs",children:[(0,o.jsxs)(s,{value:"maclinux",label:"macOS or Linux",children:[(0,o.jsx)(n.p,{children:"Run the following commands in your terminal:"}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.1/install.sh | bash\n\nexport NVM_DIR="$HOME/.nvm"\n[ -s "$NVM_DIR/nvm.sh" ] && \\. "$NVM_DIR/nvm.sh"  # This loads nvm\n\nnvm install 22\nnvm use 22\n'})})]}),(0,o.jsx)(s,{value:"win-ps",label:"Windows",children:(0,o.jsxs)(n.p,{children:["Download Node.js 20 or later from the ",(0,o.jsx)(n.a,{href:"https://nodejs.org/en/download",children:"official Node.js download page"})," and install it.\nAfter installing Node.js, create the following folder: ",(0,o.jsx)(n.code,{children:"C:\\Users\\%user%\\AppData\\Roaming\\npm"}),"\n(",(0,o.jsx)(n.code,{children:"%user%"})," is the Windows user on which you are logged in)."]})})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(r,{...e})}):r(e)}function i(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},4262:(e,n,s)=>{s.d(n,{Ay:()=>i,RM:()=>r});var o=s(4848),t=s(8453),l=s(1432);const r=[];function a(e){const n={a:"a",code:"code",p:"p",pre:"pre",...(0,t.R)(),...e.components},{TabItem:s,Tabs:r}=n;return s||c("TabItem",!0),r||c("Tabs",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(r,{groupId:"postgres-or-docker",className:"small-tabs",children:[(0,o.jsxs)(s,{value:"cloud",label:"Use Cloud Postgres",children:[(0,o.jsx)(n.p,{children:"You can connect your local application to a Postgres database hosted in DBOS Cloud."}),(0,o.jsx)(n.p,{children:"First, set a password for your DBOS Cloud database:"}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"dbos-cloud db reset-password\n"})}),(0,o.jsx)(n.p,{children:"Then connect your local app to your cloud database.\nWhen prompted, enter the password you just set."}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"dbos-cloud db local\n"})})]}),(0,o.jsxs)(s,{value:"docker",label:"Launch Postgres with Docker",children:[(0,o.jsxs)(r,{groupId:"operating-systems",className:"small-tabs",children:[(0,o.jsxs)(s,{value:"mac",label:"macOS",children:[(0,o.jsxs)(n.p,{children:["You can install Docker on macOS through ",(0,o.jsx)(n.a,{href:"https://docs.docker.com/desktop/install/mac-install/",children:"Docker Desktop"}),"."]}),(0,o.jsx)(n.p,{children:"Then, run this script to launch Postgres in a Docker container:"}),(0,o.jsx)(l.A,{language:"bash",children:`export PGPASSWORD=dbos\n# Docker may require sudo -E\n${e.cmd}`})]}),(0,o.jsxs)(s,{value:"linux",label:"Linux",children:[(0,o.jsxs)(n.p,{children:["Follow the ",(0,o.jsx)(n.a,{href:"https://docs.docker.com/engine/install/",children:"Docker Engine installation page"})," to install Docker on several popular Linux distributions."]}),(0,o.jsx)(n.p,{children:"Then, run this script to launch Postgres in a Docker container:"}),(0,o.jsx)(l.A,{language:"bash",children:`export PGPASSWORD=dbos\n# Docker may require sudo -E\n${e.cmd}`})]}),(0,o.jsxs)(s,{value:"win-ps",label:"Windows (PowerShell)",children:[(0,o.jsxs)(n.p,{children:["You can install Docker on Windows through ",(0,o.jsx)(n.a,{href:"https://docs.docker.com/desktop/install/windows-install/",children:"Docker Desktop"}),"."]}),(0,o.jsx)(n.p,{children:"Then, run this script to launch Postgres in a Docker container:"}),(0,o.jsx)(l.A,{language:"bash",children:`$env:PGPASSWORD = "dbos"\n${e.cmd}`})]}),(0,o.jsxs)(s,{value:"win-cmd",label:"Windows (cmd)",children:[(0,o.jsxs)(n.p,{children:["You can install Docker on Windows through ",(0,o.jsx)(n.a,{href:"https://docs.docker.com/desktop/install/windows-install/",children:"Docker Desktop"}),"."]}),(0,o.jsx)(n.p,{children:"Then, run this script to launch Postgres in a Docker container:"}),(0,o.jsx)(l.A,{language:"bash",children:`set PGPASSWORD=dbos\n${e.cmd}`})]})]}),(0,o.jsxs)(n.p,{children:["If successful, the script should print ",(0,o.jsx)(n.code,{children:"Database started successfully!"})]})]}),(0,o.jsx)(s,{value:"postgres",label:"Install Postgres",children:(0,o.jsxs)(r,{groupId:"operating-systems",className:"small-tabs",children:[(0,o.jsxs)(s,{value:"mac",label:"macOS",children:[(0,o.jsxs)(n.p,{children:["Follow ",(0,o.jsx)(n.a,{href:"https://www.postgresql.org/download/macosx/",children:"this guide"})," to install Postgres on macOS."]}),(0,o.jsxs)(n.p,{children:["Then, set the ",(0,o.jsx)(n.code,{children:"PGPASSWORD"})," environment variable to your Postgres password:"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"export PGPASSWORD=<your-postgres-password>\n"})})]}),(0,o.jsxs)(s,{value:"linux",label:"Linux",children:[(0,o.jsxs)(n.p,{children:["Follow these ",(0,o.jsx)(n.a,{href:"https://www.postgresql.org/download/linux/",children:"guides"})," to install Postgres on popular Linux distributions."]}),(0,o.jsxs)(n.p,{children:["Then, set the ",(0,o.jsx)(n.code,{children:"PGPASSWORD"})," environment variable to your Postgres password:"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"export PGPASSWORD=<your-postgres-password>\n"})})]}),(0,o.jsxs)(s,{value:"win-ps",label:"Windows (PowerShell)",children:[(0,o.jsxs)(n.p,{children:["Follow ",(0,o.jsx)(n.a,{href:"https://www.postgresql.org/download/windows/",children:"this guide"})," to install Postgres on Windows."]}),(0,o.jsxs)(n.p,{children:["Then, set the ",(0,o.jsx)(n.code,{children:"PGPASSWORD"})," environment variable to your Postgres password:"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'$env:PGPASSWORD = "<your-postgres-password>"\n'})})]}),(0,o.jsxs)(s,{value:"win-cmd",label:"Windows (cmd)",children:[(0,o.jsxs)(n.p,{children:["Follow ",(0,o.jsx)(n.a,{href:"https://www.postgresql.org/download/windows/",children:"this guide"})," to install Postgres on Windows."]}),(0,o.jsxs)(n.p,{children:["Then, set the ",(0,o.jsx)(n.code,{children:"PGPASSWORD"})," environment variable to your Postgres password:"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"set PGPASSWORD=<your-postgres-password>\n"})})]})]})})]}),"\n",(0,o.jsxs)(n.p,{children:["Alternatively, if you already have a Postgres database, update ",(0,o.jsx)(n.code,{children:"dbos-config.yaml"})," with its connection information."]})]})}function i(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}function c(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},8942:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>c});var o=s(4848),t=s(8453);s(2275),s(4262);const l={displayed_sidebar:"examplesSidebar",sidebar_position:11,title:"Cloud Cron Quickstart",hide_table_of_contents:!0},r=void 0,a={id:"python/examples/cron-starter",title:"Cloud Cron Quickstart",description:"Let's say you want to run some code on a schedule.  For example, you want to:",source:"@site/docs/python/examples/cron-starter.md",sourceDirName:"python/examples",slug:"/python/examples/cron-starter",permalink:"/python/examples/cron-starter",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:11,frontMatter:{displayed_sidebar:"examplesSidebar",sidebar_position:11,title:"Cloud Cron Quickstart",hide_table_of_contents:!0},sidebar:"examplesSidebar",previous:{title:"Stocks Tracker",permalink:"/python/examples/stock-tracker"},next:{title:"Checkout Workflow Tutorial",permalink:"/typescript/examples/checkout-tutorial"}},i={},c=[{value:"Tutorial",id:"tutorial",level:3},{value:"1. Select the Cloud Cron Starter",id:"1-select-the-cloud-cron-starter",level:4},{value:"2. Connect to GitHub and Deploy to DBOS Cloud",id:"2-connect-to-github-and-deploy-to-dbos-cloud",level:4},{value:"3. View Your Application",id:"3-view-your-application",level:4},{value:"4. Start Building",id:"4-start-building",level:4},{value:"Next Steps",id:"next-steps",level:3},{value:"Running It Locally",id:"running-it-locally",level:3},{value:"1. Git Clone Your Application",id:"1-git-clone-your-application",level:4},{value:"2. Set up a virtual environment",id:"2-set-up-a-virtual-environment",level:4},{value:"3. Start Your Appliation",id:"3-start-your-appliation",level:4}];function d(e){const n={a:"a",code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components},{TabItem:l,Tabs:r}=n;return l||u("TabItem",!0),r||u("Tabs",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["Let's say you want to run some code ",(0,o.jsx)(n.strong,{children:"on a schedule"}),".  For example, you want to:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Record a stock's price once a minute."}),"\n",(0,o.jsx)(n.li,{children:"Migrate some data from one database to another once an hour."}),"\n",(0,o.jsx)(n.li,{children:"Send emails to inactive users once a week."}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"This kind of code isn't easy to manage because the server running it has to always be \"on\"\u2014you can't just run it on your laptop."}),"\n",(0,o.jsxs)(n.p,{children:["In this tutorial, we'll show you how to use DBOS to ",(0,o.jsx)(n.strong,{children:"run code on a schedule in the cloud"})," so you don't have to worry about maintaining it.\nYou'll learn how to write a scheduled (cron) function in ",(0,o.jsx)(n.strong,{children:"just 11 lines of Python code"})," and deploy it to the cloud with ",(0,o.jsx)(n.strong,{children:"a single click"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"tutorial",children:"Tutorial"}),"\n",(0,o.jsx)(n.h4,{id:"1-select-the-cloud-cron-starter",children:"1. Select the Cloud Cron Starter"}),"\n",(0,o.jsxs)(n.p,{children:["Visit ",(0,o.jsx)(n.a,{href:"https://console.dbos.dev/launch",children:"https://console.dbos.dev/launch"})," and select the DBOS Cron Starter.\nWhen prompted, create a database for your app with default settings."]}),"\n",(0,o.jsx)("img",{src:s(5335).A,alt:"Cloud Console Templates",width:"800",className:"custom-img"}),"\n",(0,o.jsx)(n.h4,{id:"2-connect-to-github-and-deploy-to-dbos-cloud",children:"2. Connect to GitHub and Deploy to DBOS Cloud"}),"\n",(0,o.jsx)(n.p,{children:"To ensure you can easily update your project after deploying it, DBOS will create a GitHub repository for you.\nYou can deploy directly from that GitHub repository to DBOS Cloud."}),"\n",(0,o.jsx)(n.p,{children:"First, sign in to your GitHub account.\nThen, set your repository name and whether it should be public or private."}),"\n",(0,o.jsx)(n.p,{children:'Next, click "Create GitHub Repo and Deploy" and DBOS will clone a copy of the source code into your GitHub account, then deploy your project to DBOS Cloud.\nIn less than a minute, your app should deploy successfully.'}),"\n",(0,o.jsx)("img",{src:s(1695).A,alt:"Deploy with GitHub",width:"1000",className:"custom-img"}),"\n",(0,o.jsx)(n.h4,{id:"3-view-your-application",children:"3. View Your Application"}),"\n",(0,o.jsx)(n.p,{children:"At this point, your app is running code on a schedule in the cloud!"}),"\n",(0,o.jsxs)(n.p,{children:["To see its code, visit your new GitHub repository and open ",(0,o.jsx)(n.code,{children:"app/main.py"}),".\nThe app schedules a function incrementing a counter to run once a minute (the cron syntax ",(0,o.jsx)(n.code,{children:"* * * * *"}),' means "once a minute").\nYou can visit your app\'s URL to see the current value of the counter.']}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'from dbos import DBOS\nfrom fastapi import FastAPI\n\napp = FastAPI()\nDBOS(fastapi=app)\ncounter = 0\n\n@DBOS.scheduled("* * * * *")\n@DBOS.step()\ndef scheduled_function(scheduled_time, actual_time):\n    global counter\n    counter += 1\n\n@app.get("/")\ndef endpoint():\n    return f"The scheduled function has run {counter} times!"\n'})}),"\n",(0,o.jsx)(n.h4,{id:"4-start-building",children:"4. Start Building"}),"\n",(0,o.jsxs)(n.p,{children:["To start building, edit your application on GitHub (source code is in ",(0,o.jsx)(n.code,{children:"app/main.py"}),'), commit your changes, then press "Deploy From GitHub" on your ',(0,o.jsx)(n.a,{href:"https://console.dbos.dev/applications",children:"applications page"})," to see your changes reflected in the live application."]}),"\n",(0,o.jsx)(n.p,{children:"Not sure where to start?\nTry adding this line to the scheduled function so it logs each time it runs:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'DBOS.logger.info(f"I just ran at {scheduled_time}")\n'})}),"\n",(0,o.jsxs)(n.p,{children:["You can view your application's logs from your ",(0,o.jsx)(n.a,{href:"https://console.dbos.dev/applications",children:"applications page"}),"."]}),"\n",(0,o.jsx)("img",{src:s(8061).A,alt:"Deploy with GitHub",width:"800",className:"custom-img"}),"\n",(0,o.jsx)(n.h3,{id:"next-steps",children:"Next Steps"}),"\n",(0,o.jsxs)(n.p,{children:["You can adapt this 6-line starter to implement your own scheduled job.\nReplace ",(0,o.jsx)(n.code,{children:"scheduled_function"})," with your own function to run it on a schedule!\nSome useful implementation notes:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Schedules are specified in crontab syntax.\nFor example, ",(0,o.jsx)(n.code,{children:"* * * * *"}),' means "run once a minute."\nTo learn more about crontab syntax, see ',(0,o.jsx)(n.a,{href:"https://docs.gitlab.com/ee/topics/cron/",children:"this guide"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["The two arguments passed into ",(0,o.jsx)(n.code,{children:"scheduled_function"})," are the time the run was scheduled (as a ",(0,o.jsx)(n.code,{children:"datetime"}),") and the time the run was actually started (as a ",(0,o.jsx)(n.code,{children:"datetime"}),")."]}),"\n",(0,o.jsxs)(n.li,{children:["For more information, see the ",(0,o.jsx)(n.a,{href:"/python/tutorials/scheduled-workflows",children:"scheduling documentation"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Here are two larger examples built with DBOS scheduling:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"/python/examples/hacker-news-bot",children:(0,o.jsx)(n.strong,{children:"Hacker News Slackbot"})}),": Periodically search Hacker News for people commenting about serverless computing and post the comments to Slack."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"/python/examples/earthquake-tracker",children:(0,o.jsx)(n.strong,{children:"Earthquake Tracker"})}),": Use a scheduled job to scrape earthquake data from the USGS, then build a real-time earthquake dashboard over it."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"running-it-locally",children:"Running It Locally"}),"\n",(0,o.jsx)(n.p,{children:"You can also run your application locally for development and testing."}),"\n",(0,o.jsx)(n.h4,{id:"1-git-clone-your-application",children:"1. Git Clone Your Application"}),"\n",(0,o.jsxs)("section",{className:"row list",children:[(0,o.jsx)("article",{className:"col col--6",children:(0,o.jsx)(n.p,{children:"Clone your application from git and enter its directory."})}),(0,o.jsx)("article",{className:"col col--6",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"git clone <your-git-url>\ncd dbos-cron-starter\n"})})})]}),"\n",(0,o.jsx)(n.h4,{id:"2-set-up-a-virtual-environment",children:"2. Set up a virtual environment"}),"\n",(0,o.jsxs)("section",{className:"row list",children:[(0,o.jsx)("article",{className:"col col--6",children:(0,o.jsx)(n.p,{children:"Create a virtual environment and install dependencies."})}),(0,o.jsx)("article",{className:"col col--6",children:(0,o.jsxs)(r,{groupId:"operating-systems",className:"small-tabs",children:[(0,o.jsx)(l,{value:"maclinux",label:"macOS or Linux",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"python3 -m venv .venv\nsource .venv/bin/activate\npip install -r requirements.txt\n"})})}),(0,o.jsx)(l,{value:"win-ps",label:"Windows (PowerShell)",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"python3 -m venv .venv\n.venv\\Scripts\\activate.ps1\npip install -r requirements.txt\n"})})}),(0,o.jsx)(l,{value:"win-cmd",label:"Windows (cmd)",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"python3 -m venv .venv\n.venv\\Scripts\\activate.bat\npip install -r requirements.txt\n"})})})]})})]}),"\n",(0,o.jsx)(n.h4,{id:"3-start-your-appliation",children:"3. Start Your Appliation"}),"\n",(0,o.jsxs)("section",{className:"row list",children:[(0,o.jsx)("article",{className:"col col--6",children:(0,o.jsxs)(n.p,{children:["Start your application with ",(0,o.jsx)(n.code,{children:"dbos start"}),", then visit ",(0,o.jsx)(n.a,{href:"http://localhost:8000",children:(0,o.jsx)(n.code,{children:"http://localhost:8000"})})," to see it!"]})}),(0,o.jsx)("article",{className:"col col--6",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"dbos start\n"})})})]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}function u(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},5335:(e,n,s)=>{s.d(n,{A:()=>o});const o=s.p+"assets/images/1-pick-template-1881b2907a4dece0d05d91813ac17af4.png"},1695:(e,n,s)=>{s.d(n,{A:()=>o});const o=s.p+"assets/images/2-ready-deploy-d8c1db058b5a94e15696f97bfbf54f58.png"},8061:(e,n,s)=>{s.d(n,{A:()=>o});const o=s.p+"assets/images/4-app-page-e690dec0fa39d55e66fb85012d5a796f.png"}}]);