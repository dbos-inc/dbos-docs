"use strict";(self.webpackChunkdbos_docs=self.webpackChunkdbos_docs||[]).push([[7203],{3539:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"typescript/reference/configuration","title":"Configuration","description":"Configuring DBOS","source":"@site/docs/typescript/reference/configuration.md","sourceDirName":"typescript/reference","slug":"/typescript/reference/configuration","permalink":"/typescript/reference/configuration","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"sidebar_position":20,"title":"Configuration"},"sidebar":"tutorialSidebar","previous":{"title":"Event Receivers","permalink":"/typescript/reference/transactapi/eventreceivercontext"},"next":{"title":"DBOS Client","permalink":"/typescript/reference/client"}}');var t=s(4848),o=s(8453);const r={sidebar_position:20,title:"Configuration"},a=void 0,l={},c=[{value:"Configuring DBOS",id:"configuring-dbos",level:2},{value:"DBOS Configuration File",id:"dbos-configuration-file",level:2},{value:"Configuration File Fields",id:"configuration-file-fields",level:3},{value:"Database Section",id:"database-section",level:4},{value:"Runtime Section",id:"runtime-section",level:4},{value:"Configuration Schema File",id:"configuration-schema-file",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"configuring-dbos",children:"Configuring DBOS"}),"\n",(0,t.jsxs)(n.p,{children:["To configure DBOS, pass in a configuration with ",(0,t.jsx)(n.code,{children:"DBOS.setConfig"})," before you call ",(0,t.jsx)(n.code,{children:"DBOS.launch"}),".\nFor example:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"DBOS.setConfig({\n  name: 'my-app',\n  databaseUrl: process.env.DBOS_DATABASE_URL,\n});\nawait DBOS.launch();\n"})}),"\n",(0,t.jsxs)(n.p,{children:["A configuration object has the following fields.\nAll fields except ",(0,t.jsx)(n.code,{children:"name"})," are optional."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"export interface DBOSConfig {\n  name?: string;\n  readonly databaseUrl?: string;\n  readonly userDbclient?: UserDatabaseName;\n  readonly sysDbName?: string;\n  readonly userDbPoolSize?: number;\n  readonly sysDbPoolSize?: number;\n  readonly logLevel?: string;\n  readonly otlpTracesEndpoints?: string[];\n  readonly runAdminServer?: boolean;\n  readonly adminPort?: number;\n}\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"name"}),": Your application's name."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"databaseUrl"}),": A connection string to a Postgres database. The supported format is"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"postgresql://[username]:[password]@[hostname]:[port]/[database name]\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"sslmode=require"}),", ",(0,t.jsx)(n.code,{children:"sslmode=verify-full"}),", ",(0,t.jsx)(n.code,{children:"sslrootcert"})," and ",(0,t.jsx)(n.code,{children:"connect_timeout"})," parameter keywords are also supported.\nDefaults to:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"postgresql://postgres:dbos@localhost:5432/[application name]\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"userDbclient"}),": If using DBOS transactions, the database client to use. Must be one of ",(0,t.jsx)(n.code,{children:"knex"}),", ",(0,t.jsx)(n.code,{children:"drizzle"}),", ",(0,t.jsx)(n.code,{children:"typeorm"}),", or ",(0,t.jsx)(n.code,{children:"prisma"}),".  Defaults to ",(0,t.jsx)(n.code,{children:"knex"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"sysDbName"}),": Name for the ",(0,t.jsx)(n.a,{href:"../../explanations/system-tables",children:"system database"})," in which DBOS stores internal state. Defaults to ",(0,t.jsx)(n.code,{children:"{database name}_dbos_sys"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"userDbPoolSize"}),": The size of the connection pool used by ",(0,t.jsx)(n.a,{href:"/typescript/tutorials/transaction-tutorial",children:"transactions"})," to connect to your application database. Defaults to 20."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"sysDbPoolSize"}),": The size of the connection pool used for the ",(0,t.jsx)(n.a,{href:"../../explanations/system-tables",children:"DBOS system database"}),". Defaults to 2."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"logLevel"}),": Configure the ",(0,t.jsx)(n.a,{href:"/typescript/tutorials/logging",children:"DBOS logger"})," severity. Defaults to ",(0,t.jsx)(n.code,{children:"info"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"otlpTracesEndpoints"}),": DBOS operations ",(0,t.jsx)(n.a,{href:"/typescript/tutorials/logging",children:"automatically generate OpenTelemetry Traces"}),". Use this field to declare a list of OTLP-compatible receivers."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"runAdminServer"}),": Whether to run an ",(0,t.jsx)(n.a,{href:"/production/self-hosting/admin-api",children:"HTTP admin server"})," for workflow management operations. Defaults to True."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"adminPort"}),": The port on which the admin server runs. Defaults to 3001."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"dbos-configuration-file",children:"DBOS Configuration File"}),"\n",(0,t.jsxs)(n.p,{children:["Many tools in the DBOS ecosystem are configured by a ",(0,t.jsx)(n.code,{children:"dbos-config.yaml"})," file.\nTools that use ",(0,t.jsx)(n.code,{children:"dbos-config.yaml"})," include the ",(0,t.jsx)(n.a,{href:"/typescript/reference/tools/cli",children:"DBOS CLI"}),", ",(0,t.jsx)(n.a,{href:"/typescript/tutorials/debugging",children:"DBOS debugger"}),", and ",(0,t.jsx)(n.a,{href:"/production/dbos-cloud/deploying-to-cloud",children:"DBOS Cloud"}),".\nAdditionally, the DBOS library will fall back to ",(0,t.jsx)(n.code,{children:"dbos-config.yaml"})," if no configuration object is provided."]}),"\n",(0,t.jsx)(n.p,{children:"Here is an example configuration file with default parameters:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"name: my-app\nlanguage: node\ndatabase_url: ${DBOS_DATABASE_URL}\nruntimeConfig:\n  start:\n    - node dist/main.js\n"})}),"\n",(0,t.jsx)(n.h3,{id:"configuration-file-fields",children:"Configuration File Fields"}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["You can use environment variables for configuration values through the syntax ",(0,t.jsx)(n.code,{children:"field: ${VALUE}"}),"."]})}),"\n",(0,t.jsxs)(n.p,{children:["Each ",(0,t.jsx)(n.code,{children:"dbos-config.yaml"})," file has the following fields and sections:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"name"}),": Your application's name. Must match the name supplied to the DBOS constructor."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"language"}),": The application language. Must be set to ",(0,t.jsx)(n.code,{children:"node"})," for TypeScript applications."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"database_url"}),": A connection string to a Postgres database. This connection string is used by tools such as the ",(0,t.jsx)(n.a,{href:"/typescript/reference/tools/cli",children:"DBOS CLI"})," and ",(0,t.jsx)(n.a,{href:"/typescript/tutorials/debugging",children:"DBOS debugger"}),". It has the same format as (and should match) the connection string you pass to the DBOS constructor."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"database"}),": The ",(0,t.jsx)(n.a,{href:"#database-section",children:"database section"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"runtimeConfig"}),": The ",(0,t.jsx)(n.a,{href:"#runtime-section",children:"runtime section"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"database-section",children:"Database Section"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"migrate"}),": A list of commands to run to apply your application's schema to the database."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"sys_db_name"}),": Name for the ",(0,t.jsx)(n.a,{href:"../../explanations/system-tables",children:"system database"})," in which DBOS stores internal state. Defaults to ",(0,t.jsx)(n.code,{children:"{database name}_dbos_sys"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"database:\n  sys_db_name: 'my_dbos_system_db'\n  migrate:\n    - npx knex migrate:latest\n"})}),"\n",(0,t.jsx)(n.h4,{id:"runtime-section",children:"Runtime Section"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"start"}),": The command(s) with which to start your app. Called from ",(0,t.jsx)(n.a,{href:"/typescript/reference/tools/cli#npx-dbos-start",children:(0,t.jsx)(n.code,{children:"npx dbos start"})}),", which is used to start your app in DBOS Cloud."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"entrypoints"})," (optional): The compiled JavaScript files where DBOS looks for your application's code. This should only be used if you are using scheduled workflows, Kafka consumers, or DBOS HTTP decorators in files that are not referenced by your start command. At startup, the DBOS runtime automatically loads all classes exported from these files, serving their endpoints and registering their decorated functions. Defaults to [dist/operations.js]."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"setup"}),": (optional) Setup commands to run before your application is built in DBOS Cloud. Used only in DBOS Cloud. Documentation ",(0,t.jsx)(n.a,{href:"/production/dbos-cloud/application-management#customizing-microvm-setup",children:"here"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Example"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'runtimeConfig:\n  start:\n    - "node dist/main.js"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"configuration-schema-file",children:"Configuration Schema File"}),"\n",(0,t.jsxs)(n.p,{children:["There is a schema file available for the DBOS configuration file schema ",(0,t.jsx)(n.a,{href:"https://raw.githubusercontent.com/dbos-inc/dbos-ts/main/dbos-config.schema.json",children:"in GitHub"}),".\nThis schema file can be used to provide an improved YAML editing experience for developer tools that leverage it.\nFor example, the Visual Studio Code ",(0,t.jsx)(n.a,{href:"https://marketplace.visualstudio.com/items?itemName=redhat.vscode-yaml",children:"RedHat YAML extension"})," provides tooltips, statement completion and real-time validation for editing DBOS config files.\nThis extension provides ",(0,t.jsx)(n.a,{href:"https://github.com/redhat-developer/vscode-yaml#associating-schemas",children:"multiple ways"})," to associate a YAML file with its schema.\nThe easiest is to simply add a comment with a link to the schema at the top of the config file:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"# yaml-language-server: $schema=https://github.com/dbos-inc/dbos-transact-py/blob/main/dbos/dbos-config.schema.json\n"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>a});var i=s(6540);const t={},o=i.createContext(t);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);