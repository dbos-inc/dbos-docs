"use strict";(self.webpackChunkdbos_docs=self.webpackChunkdbos_docs||[]).push([[9425],{2357:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"integrations/django","title":"Django","description":"This guide shows you how to add the open source DBOS Transact library to your existing Django application to durably execute it and make it resilient to any failure.","source":"@site/docs/integrations/django.md","sourceDirName":"integrations","slug":"/integrations/django","permalink":"/integrations/django","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":39,"frontMatter":{"sidebar_position":39,"title":"Django"},"sidebar":"tutorialSidebar","previous":{"title":"Nest.js","permalink":"/integrations/nestjs"},"next":{"title":"DBOS System Tables","permalink":"/explanations/system-tables"}}');var s=o(4848),a=o(8453);const i={sidebar_position:39,title:"Django"},r="Make Your Django App Reliable with DBOS",l={},d=[{value:"Installation and Requirements",id:"installation-and-requirements",level:2},{value:"Starting DBOS",id:"starting-dbos",level:2},{value:"Making Your Views Reliable",id:"making-your-views-reliable",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components},{Details:o}=n;return o||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"make-your-django-app-reliable-with-dbos",children:"Make Your Django App Reliable with DBOS"})}),"\n",(0,s.jsxs)(n.p,{children:["This guide shows you how to add the open source ",(0,s.jsx)(n.a,{href:"https://github.com/dbos-inc/dbos-transact-py",children:"DBOS Transact"})," library to your existing ",(0,s.jsx)(n.a,{href:"https://www.djangoproject.com/",children:"Django"})," application to ",(0,s.jsx)(n.strong,{children:"durably execute"})," it and make it resilient to any failure."]}),"\n",(0,s.jsx)(n.p,{children:"In summary you'll need to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Start DBOS with your ",(0,s.jsx)(n.a,{href:"https://docs.djangoproject.com/en/5.2/ref/applications/#django.apps.AppConfig.ready",children:"AppConfig's ready method"})]}),"\n",(0,s.jsx)(n.li,{children:"Annotate your service methods with DBOS decorators to make them durable"}),"\n",(0,s.jsxs)(n.li,{children:["Start Django with the ",(0,s.jsx)(n.code,{children:"--noreload"})," flag."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"installation-and-requirements",children:"Installation and Requirements"}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["The guide is based on the Django ",(0,s.jsx)(n.a,{href:"https://docs.djangoproject.com/en/5.2/intro/tutorial01/",children:"quickstart"}),", will show you how to make your application reliable with ",(0,s.jsx)(n.a,{href:"https://github.com/dbos-inc/dbos-transact-py",children:"DBOS Transact"}),"."]})}),"\n",(0,s.jsxs)(o,{children:[(0,s.jsx)("summary",{children:"Setting up the Django quickstart"}),(0,s.jsx)(n.p,{children:"This application was created with:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"python3 -m venv .venv\nsource .venv/bin/activate\npip install django\ndjango-admin startproject djangodbos .\npython manage.py startapp polls\n"})}),(0,s.jsxs)(n.p,{children:["Then, configure ",(0,s.jsx)(n.code,{children:"djangodbos/settings.py"})," to ",(0,s.jsx)(n.a,{href:"https://docs.djangoproject.com/en/5.2/ref/settings/#databases",children:"use Postgres"})," and run ",(0,s.jsx)(n.code,{children:"python manage.py migrate"}),"."]})]}),"\n",(0,s.jsx)(n.p,{children:"Install DBOS Python with:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"pip install dbos\n"})}),"\n",(0,s.jsx)(n.h2,{id:"starting-dbos",children:"Starting DBOS"}),"\n",(0,s.jsxs)(n.p,{children:["In your Django application ",(0,s.jsx)(n.code,{children:"AppConfig"}),", start DBOS inside the ",(0,s.jsx)(n.code,{children:"ready"})," method. You can ",(0,s.jsx)(n.a,{href:"https://docs.dbos.dev/python/reference/configuration",children:"configure the DBOS instance"})," before ",(0,s.jsx)(n.a,{href:"https://docs.dbos.dev/python/reference/dbos-class#launch",children:"launching DBOS"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import os\nfrom django.apps import AppConfig\nfrom dbos import DBOS, DBOSConfig\n\nclass PollsConfig(AppConfig):\n    default_auto_field = \'django.db.models.BigAutoField\'\n    name = \'polls\'\n\n    def ready(self):\n        dbos_config: DBOSConfig = {\n            "name": "django-app",\n            "system_database_url": os.environ.get("DBOS_SYSTEM_DATABASE_URL"),\n        }\n        DBOS(config=dbos_config)\n        DBOS.launch()\n        return super().ready()\n'})}),"\n",(0,s.jsxs)(n.p,{children:["We recommend you call ",(0,s.jsx)(n.code,{children:"python manage.py runserver"})," with the ",(0,s.jsx)(n.code,{children:"--noreload"})," flag to avoid repeatedly relaunching DBOS during development."]}),"\n",(0,s.jsx)(n.h2,{id:"making-your-views-reliable",children:"Making Your Views Reliable"}),"\n",(0,s.jsxs)(n.p,{children:["You can make a Django view durable using DBOS ",(0,s.jsx)(n.a,{href:"/python/tutorials/workflow-tutorial",children:"workflows"})]}),"\n",(0,s.jsxs)(n.p,{children:["In this example, we'll write a ",(0,s.jsx)(n.code,{children:"callWorkflow"})," endpoint that invokes a ",(0,s.jsx)(n.a,{href:"../python/tutorials/workflow-tutorial",children:"workflow"})," of two steps."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'def callWorkflow(request, a, b):\n    return JsonResponse(workflow(a, b))\n\n\n@DBOS.step()\ndef step_one(a):\n    print("Step one completed!", a)\n\n@DBOS.step()\ndef step_two(b):\n    print("Step two completed!", b)\n\n@DBOS.workflow()\ndef workflow(a, b):\n    step_one(a)\n    step_two(b)\n    return {"result": "success"}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Update ",(0,s.jsx)(n.code,{children:"polls/urls.py"})," and run your app with ",(0,s.jsx)(n.code,{children:"python manage.py runserver --noreload"})," to access the view at ",(0,s.jsx)(n.code,{children:"http://localhost:8000/polls/callWorkflow/a/b"}),"."]})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>r});var t=o(6540);const s={},a=t.createContext(s);function i(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);